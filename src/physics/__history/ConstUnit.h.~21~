//---------------------------------------------------------------------------

#ifndef ConstUnitH
#define ConstUnitH

#ifndef RSLINAC
#include <Graphics.hpp>
#endif
//SYSTEM
const int MAX_DIGITS=6;
const int DigitConst=1e6;
const int MAX_CHAR=256;
const int PIT_LENGTH=10;
const int PID_LENGTH=9;

//PHYSICAL
const double c=2.99792458e8;
//const double pi=3.1415926;
const double pi=M_PI;
const double We0=0.5110034e6;
const double Ia=17068;//Alfen Current
const double eps0=8.85418782e-12;
const double myu0=1.25663706e-6;
const double kF=1/(4*pi*eps0);
const double kFc=1/(4*pi*eps0*c);
const double qe=1.60217711444647E-19;
const double me=9.10938344542608E-31;

//OPTIMIZER
const double RS=0.61803399;
const double G=1-RS;
const int Nerr=1;
const int Nstep=10;
const double CurrentStep=100;  //mA
const double CurrentErr=2; //mA
const double Eerr=0.5;
const double Estep=10;

//NUMERICAL
const double MaxPhase=2*360;
const double MinPhase=-MaxPhase;
const int PointsNumber=1000;
const int SeparatrixNumber=20;
const double SpecLevel=0.5;
const double EnergyLimit=1e6;// MeV

//COLORS
#ifndef RSLINAC
const TColor Line1_col_a=clRed;
const TColor Line1_col_b=clMaroon;
const TColor Line2_col_a=clBlue;
const TColor Line2_col_b=clNavy;
const TColor Particle_col=clRed;
const TColor Envelope_col=clBlue;
const TColor clOrange=0x000080FF;
#endif

//FILES
const char CST_FileX[]="cst_x.txt";
const char CST_FileY[]="cst_y.txt";
const char CST_FileR[]="cst_r.txt";
const char Solenoid_File[]="BFIELD.txt";
const char Energy_File[]="ENERGY_FILE.txt";

//TABLES
const int Nb12=5;
const int Nb23=4;
const int Nb43=4;
const double B12[Nb12]={0.4,0.5,0.6,0.8,1.0};
const double B23[Nb23]={0.4,0.6,0.8,1.0};
const double B43[Nb43]={0.4,0.6,0.8,1.0};

const int Ne12=7;
const int Ne23=7;
//const int Ne23=5;
const int Ne43=5;

const double E12[Nb12][Ne12]=
{127,162,212,282,398,590,973,
98,131,180,250,358,543,902,
80,90,138,205,314,490,820,
42,69,115,174,265,424,729,
0,41,75,129,213,260,620};
const double E23[Nb23][Ne23]=
/*{318,349,396,472,679.4,
318,349,396,472,679.4,
318,349,396,472,679.4,
318,349,396,472,679.4}; */
{118,152,200,270,380,575,980,
105,134,180,250,364,557,937,
62,96,140,204,307,475,825,
47,57,95,149,227,365,618};
const double E43[Nb43][Ne43]=
{287.5,321,403,508,682,
287.5,321,403,508,682,
287.5,321,403,508,682,
287.5,321,403,508,682};

const double R12[Nb12][Ne12]=
{0.2164,0.1887,0.1634,0.1401,0.1182,0.0973,0.0772,
0.2242,0.1936,0.1664,0.1419,0.1192,0.0978,0.0774,
0.2361,0.2013,0.1713,0.1448,0.1208,0.0987,0.0778,
0.2437,0.2066,0.1748,0.1569,0.1220,0.0983,0.0781,
0.25,0.2131,0.1792,0.1498,0.1238,0.1002,0.0786};
const double R23[Nb23][Ne23]=
/*{0.062,0.061,0.06,0.059,0.058,
0.062,0.061,0.06,0.059,0.058,
0.062,0.061,0.06,0.059,0.058,
0.062,0.061,0.06,0.059,0.058};  */
{0.2158,0.1881,0.1629,0.1396,0.1179,0.0971,0.0771,
0.2234,0.1928,0.1658,0.1413,0.1187,0.0975,0.0773,
0.2344,0.1999,0.1702,0.1438,0.1202,0.0983,0.0786,
0.2495,0.2105,0.1774,0.1485,0.1228,0.0996,0.0782};
const double R43[Nb43][Ne43]=
{0.082,0.081,0.08,0.079,0.078,
0.082,0.081,0.08,0.079,0.078,
0.082,0.081,0.08,0.079,0.078,
0.082,0.081,0.08,0.079,0.078};


const int Nar23=5;
const int Nar43=5;
const int Nab23=4;

const double AR[Nar23]={0.10,0.12,0.14,0.16,0.18};
//const double AR[Nar43]={0.058,0.059,0.06,0.061,0.062};
const double AR43[Nar43]={0.078,0.079,0.08,0.081,0.082};
const double AB[Nab23]={0.4,0.6,0.8,1.0};

const double A12[Nab23][Nar23]=
{307.0,196.0,142.0,112.0,94.4,
139.0,74.4,52.1,37.6,29.1,
94.7,52.7,32.8,22.4,16.5,
80.0,42.0,25.4,16.8,12.0};
const double A23[Nab23][Nar23]=
/*{92.0,50.7,37.1,30.3,26.0,
92.0,50.7,37.1,30.3,26.0,
92.0,50.7,37.1,30.3,26.0,
92.0,50.7,37.1,30.3,26.0,}; */
{200.0,122.0,88.0,62.0,55.0,
120.0,68.0,40.0,27.0,22.0,
90.0,50.0,28.0,18.5,14.0,
80.0,40.0,24.0,15.0,11.0};   
const double A43[Nab23][Nar43]=
{57.4,32.96,22.13,16.35,13.11,
57.4,32.96,22.13,16.35,13.11,
57.4,32.96,22.13,16.35,13.11,
57.4,32.96,22.13,16.35,13.11};

//FORM FACTORS
const int Nryrx=10;
const int Nrxrz=12;
const double RYRX[Nryrx]={0.01,0.1,0.2,0.4,0.6,0.8,1.0,2.0,5.0,10.0};
const double RXRZ[Nrxrz]={0.01,0.1,0.5,1.0,1.5,2.0,2.5,3.0,3.5,4.0,4.5,5.0};
const double MX[Nrxrz][Nryrx]= {
1.97974883e-02,1.81773306e-01,3.33243807e-01,5.71250922e-01,7.49736178e-01,8.88540990e-01,9.99570101e-01,1.33252121e+00,1.66489840e+00,1.81516900e+00,
1.95805138e-02,1.79607790e-01,3.28934584e-01,5.62767803e-01,7.37265532e-01,8.72280729e-01,9.79714120e-01,1.29720325e+00,1.59895391e+00,1.72160855e+00,
1.77201419e-02,1.61090858e-01,2.92336359e-01,4.92157176e-01,6.35947573e-01,7.43505417e-01,8.26436002e-01,1.05440057e+00,1.23750583e+00,1.29720325e+00,
1.55102931e-02,1.39195723e-01,2.49516088e-01,4.11846482e-01,5.24174084e-01,6.05559662e-01,6.66666667e-01,8.26436002e-01,9.44179030e-01,9.79714120e-01,
1.37964514e-02,1.22305841e-01,2.16854673e-01,3.52193416e-01,4.43208682e-01,5.07789732e-01,5.55510413e-01,6.76997218e-01,7.63069955e-01,7.88282205e-01,
1.24091347e-02,1.08709726e-01,1.90840485e-01,3.05726028e-01,3.81313342e-01,4.34161824e-01,4.72799717e-01,5.69560963e-01,6.36606296e-01,6.55944234e-01,
1.13139433e-02,9.80376308e-02,1.70623887e-01,2.70292617e-01,3.34802167e-01,3.79441757e-01,4.11846482e-01,4.92157176e-01,5.47067420e-01,5.62767803e-01,
1.03661070e-02,8.88554545e-02,1.53393334e-01,2.40586156e-01,2.96267354e-01,3.34490317e-01,3.62089653e-01,4.29981076e-01,4.75975850e-01,4.89051538e-01,
9.56657141e-03,8.11571157e-02,1.39078326e-01,2.16267434e-01,2.65034534e-01,2.98307956e-01,3.22239200e-01,3.80793992e-01,4.20212679e-01,4.31375789e-01,
9.02544513e-03,7.59756526e-02,1.29517531e-01,2.00214690e-01,2.44573026e-01,2.74724343e-01,2.96358513e-01,3.49125891e-01,3.84518634e-01,3.94519846e-01,
8.42890573e-03,7.02946414e-02,1.19109383e-01,1.82917101e-01,2.22663631e-01,2.49576726e-01,2.68841608e-01,3.15685091e-01,3.46994155e-01,3.55823279e-01,
7.99552473e-03,6.61904584e-02,1.11641940e-01,1.70623887e-01,2.07180780e-01,2.31870445e-01,2.49516088e-01,2.92336359e-01,3.20892228e-01,3.28934584e-01
};


//GAUSS INTEGRATION
/*    const double psi5[5]  ={-0.9061798,-0.5384093,0.0,0.5384093,0.9061798};
	const double w5[5]    ={0.2369269,0.4786287,0.5688889,0.4786287,0.2369269};
	const double psi6[6]  ={-0.9324695,-0.6612094,-0.2386192,0.2386192,0.6612094,0.9324695};
	const double w6[6]    ={0.1713245,0.3607616,0.4679139,0.4679139,0.3607616,0.1713245};
	const double psi7[7]  ={-0.9491079,-0.7415312,-0.4058452,0.0,      0.4058452,0.7415312,0.9491079};
	const double w7[7]    ={ 0.1294850, 0.2797054, 0.3818301,0.4179592,0.3818301,0.2797054,0.1294850};
	const double psi8[8]  ={-0.9602899,-0.7966665,-0.5255324,-0.1834346,0.1834346,0.5255324,0.7966665,0.9602899};
	const double w8[8]    ={ 0.1012285, 0.2223810, 0.3137066, 0.3626838,0.3626838,0.3137066,0.2223810,0.1012285};
	const double psi9[9]  ={-0.9681602,-0.8360311,-0.6133714,-0.3242534,0.0,      0.3242534,0.6133714,0.8360311,0.9681602};
	const double w9[9]    ={ 0.0812744, 0.1806482, 0.2606107, 0.3123471,0.3302394,0.3123471,0.2606107,0.1806482,0.0812744};
	const double psi10[10]={-0.9739065,-0.8650634,-0.6794096,-0.4333954,-0.1488743,0.1488743,0.4333954,0.6794096,0.8650634,0.9739065};
	const double w10[10]  ={ 0.0666713, 0.1494513, 0.2190864, 0.2692602, 0.2955242,0.2955242,0.2692602,0.2190864,0.1494513,0.0666713};
	const double psi11[11]={-0.9782287,-0.8870626,-0.7301520,-0.5190961,-0.2695432,0.0,
					   0.2695432, 0.5190961, 0.7301520, 0.8870626, 0.9782287};
	const double w11[11]  ={ 0.0556686, 0.1255804, 0.1862902, 0.2551938, 0.2628045,0.2729251,
					   0.2628045, 0.2331938, 0.1862902, 0.1255804, 0.0556686};
*/
	const double psi12[12]={-0.9815606,-0.9041173,-0.7699027,-0.5873180,-0.3678315,-0.1253334,
					   0.1253334, 0.3678315, 0.5873180, 0.7699027, 0.9041173, 0.9815606};
	const double w12[12]  ={ 0.0471753, 0.1069393, 0.1600783, 0.2031674, 0.2334925, 0.2491470,
					   0.2491470, 0.2334925, 0.2031674, 0.1600783, 0.1069393, 0.0471753};
/*
	const double psi16[16]={-0.9894009,-0.9445750,-0.8656312,-0.7554044,-0.6178762,-0.4580168,-0.2816036,-0.0950125,
					   0.0950125, 0.2816036, 0.4580168, 0.6178762, 0.7554044, 0.8656312, 0.9445750, 0.9894009};
	const double w16[16]  ={ 0.0271525, 0.0622535, 0.0951585, 0.1246290, 0.1495960, 0.1691565, 0.1826034, 0.1894506,
					   0.1894506, 0.1826034, 0.1691565, 0.1495960, 0.1246290, 0.0951585, 0.0622535, 0.0271525};
*/
//---------------------------------------------------------------------------
#endif
